
<!DOCTYPE html>
<html>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <link rel="stylesheet" href="index.css">
    
    <script type="module" src="client.js"></script>
    <head>
        <p>Welcome, <%= username %><p>
        <% if(loggedIn === true) { %>
            <button id="logout">Log Out</button>
        <% } else {  %>
            <form action="/auth/discord" method="get" id="authdiscord"></form>
            <button type="submit" form="authdiscord" id="discordbutton">Sign in with Discord</button>
            <form action="/auth/google" method="get" id="authgoogle"></form>
            <button type="submit" form="authgoogle" id="googlebutton">Sign in with
                Google</button>
        <% } %>

        <title>Genshin Impact Artifact Sim</title>
    </head>
    <body>
        <h1>Genshin Impact Artifact Sim</h1>
        <p>Copium</p>
    </body>

<!--
<form action="/artifacts" method="POST">
    <input type="text" placeholder="name" name="name">
    <input type="text" placeholder="description" name="desc">
    <button type="submit">Submit</button>
</form>
-->

    <h2> Domains </h2>
    <h3> Hidden Palace of Zhou Formula </h3>
    <button id="roll-hidden_palace">
    <img src = "images/Item_Flower_of_Blaze.png" width= "100" height: "100"></button>

    <h3> Peak of Vindagnyr </h3>
    <button id ="roll-vindagnyr">
    <img src = "images/Item_Snowswept_Memory.png" width= "100" height: "100"></button>


    <h2> Artifacts </h2>
    <span hidden id ="resindate"><%=resinDate%></span>
    <span>Time to next resin: </span>
    <span id ="resintimer"></span><br/>

    <span>Resin: </span>
    <span id ="resincount"><%= resin %></span><br/>
    <script language="JavaScript">
    function toggle(source) {
      checkboxes = document.getElementsByName('check');
        for(var i=0, n=checkboxes.length;i<n;i++) {
            checkboxes[i].checked = source.checked;
        }
    }
    function test(obj){
        //console.log(obj);
        var radio = document.getElementById('radio' + obj._id);
        console.log(radio.checked);
        if(radio.checked === false) {
            radio.checked = true;
            var cardheader = document.getElementById('cardheader');
            cardheader.innerHTML = obj.name; 
            document.getElementById('cardmain').innerHTML = obj.main;
            document.getElementById('cardmainVal').innerHTML = obj.mainVal;
        } 
    }
    </script>

    <input type="checkbox" onClick="toggle(this)" /> Toggle All<br/>
    <button type="submit" form="deleteform" id="deleteformid">Delete</button>
    <button type="submit" form="levelform">Level</button>

    <% if(artifacts[0]) { %>
    <div class="card">
        <header class="card-header">
            <p class="card-header-title is-centered" id= cardheader>
              <%= artifacts[0].name %>
            </p>
        </header>
        <div class="card-image">
            <figure class="image is-128x128">
            <img src="images/Item_Flower_of_Blaze.png" alt="Placeholder image">
            </figure>
        </div>
        <div class="card-content">
            <div class="media">
                <div class="media-right" id="lock">
                    <figure class="image is-24x24">
                    <img src="images/lock.png" alt="Placeholder image">
                    </figure>
                </div>
                <div class="media-content" id="card-main">
                    <p class="subtitle is-6" id="cardmain"> <%- artifacts[0].main %></p>
                    <p class="title is-4" id="cardmainVal"><%- artifacts[0].mainVal %></p>
                </div>
            </div>

            <div class="content" id="cardstats">
                <ul>
                    <% for(var j = 0; j < artifacts[0].subOrder.length; j++) {%>
                        <li><%= artifacts[0].subOrder[j] %>+<%=Math.round(artifacts[0][artifacts[0].subOrder[j]]*10)/10 %><br/></li>
                    <% } %>
                </ul>
            </div>

            <div class="content">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                Phasellus nec iaculis mauris. <a>@bulmaio</a>.
                <a href="#">#css</a> <a href="#">#responsive</a>
                <br>
                <time datetime="2016-1-1">11:09 PM - 1 Jan 2016</time>
            </div>
        </div>
        <footer class="card-footer">
            <button type="button" id="footerbutton" class="card-footer-item">Details</button>
          </footer>
    </div>
    <% } %>

    <ul class="artifacts">
        <!-- Loop through quotes -->
        <form action="/delete" method="post" id="deleteform"></form>
        <form action="/level" method="post" id="levelform"></form>

        <% for(var i = 0; i < artifacts.length; i++) {%>
        <!-- ><script language ="JavaScript"> var radio = document.getElementById('radio' + '<%=artifacts[i]._id%>'); </script> <!-->
        <!--<li class="artifact"> -->
        <button type="button" id= "button<%=artifacts[i]._id%>" onclick="test(<%= JSON.stringify(artifacts[i]) %>)">
                <span><input type="checkbox" name="check" value="<%=
                                   artifacts[i]._id%>" autocomplete="off" form="deleteform"/></span>

                <% for(var j = 0; j < artifacts[i].rarity; j++) {%>
                    <span>&#11088</span>
                <% } %>
                <span><input type="radio" id= "radio<%=artifacts[i]._id%>" name="pickArtifact"
                    value="<%=artifacts[i]._id%>" autocomplete="off" form="levelform"></span><br/>
                <span><label for= "radio<%=artifacts[i]._id%>"> <span><%= artifacts[i].name
                             %></span><br/>
                         <span id = "level<%= artifacts[i]._id %>">+<%= artifacts[i].level %> <%= artifacts[i].slot %></span><br/>

                <span id = "xp<%= artifacts[i]._id %>"><%=Math.abs((artifacts[i].requiredCumulativeXP-artifacts[i].cumulativeXP)-artifacts[i].requiredXP) %>/<%= artifacts[i].requiredXP %> XP</span><br/>
                <span style="font-weight:bold"><%= artifacts[i].main %></span><br/>
                <span id =
                    "main<%=artifacts[i]._id%>"><%=Math.round(artifacts[i].mainVal*10)/10 %></span><br/>
                <span id = "subs<%=artifacts[i]._id%>">

                <% for(var j = 0; j < artifacts[i].subOrder.length; j++) {%>
                    <%= artifacts[i].subOrder[j] %>: <%=Math.round(artifacts[i][artifacts[i].subOrder[j]]*10)/10 %><br/>
                <% } %>
                </span>
                </button>
                <!-- </li>-->
        <% } %>
    </ul>
</html>
